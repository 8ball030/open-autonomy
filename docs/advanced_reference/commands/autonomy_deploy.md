
## Usage

```bash
autonomy deploy [OPTIONS] COMMAND [ARGS]
```

## Description

Build or run agent service deployments.


## Options
`--help`

:   Show the help message and exit.




## Subcommand `autonomy deploy build`

### Usage

```bash
autonomy deploy build [OPTIONS] [KEYS_FILE]
```

### Description

Build a service deployment. This command must be executed within a service folder. That is, a folder containing the service configuration file (`service.yaml`). The deployment will be created in the subfolder `./abci_build`.


### Options

`--o PATH`
:   Path to output dir.

`--n INTEGER`
:   Number of agents.

`--docker`
:   Use docker as a backend.

`--kubernetes`
:   Use kubernetes as a backend.

`--dev`
:   Create development environment.

`--force`
:   Remove existing build and overwrite with new one.

`--log-level [INFO|DEBUG|WARNING|ERROR|CRITICAL]`
:   Logging level for runtime.

`--packages-dir PATH`
:   Path to packages dir (Use with `dev` mode).

`--open-aea-dir PATH`
:   Path to open-aea repo (Use with `dev` mode).

`--open-autonomy-dir PATH`
:   Path to open-autonomy repo (Use with `dev` mode).

`--aev`
:   Apply environment variable when loading service config.

`--use-hardhat`
:   Include a hardhat node in the deployment setup.

`--use-acn`
:   Include an ACN node in the deployment setup.

`--image-version TEXT`
:   Define runtime image version.

`--remote`
:   To use a remote registry.

`--local`
:   To use a local registry.

`-p`
:   Ask for password interactively.

`--password PASSWORD`
:   Set password for key encryption/decryption.

`--help`
:   Show the help message and exit.


### Examples
```bash
autonomy deploy build keys.json --aev
```

Builds a service deployment using the keys sroted in the file `keys.json` and applying environment variables to the service configuration file. The deployment will be generated by default for as many agents as keys are stored in `keys.json`.




## Subcommand `autonomy deploy run`

### Usage

```bash
autonomy deploy run [OPTIONS]
```

### Description

Run a service deployment locally stored. This command is a wrapper around `docker-compose up` to run the service deployment. To execute this command you need to be located within the deployment environment subfolder (`./abci_build`), or specify it with the option `--build-dir`.

### Options

`--build-dir PATH`
:   

`--no-recreate`
:   If containers already exist, dont recreate them.

`--remove-orphans`
:   Remove containers for services not defined in the Compose file.

`--help`
:   Show the help message and exit.

### Examples
```bash
autonomy deploy run --build-dir /abci_build
```

Runs the service deployment stored locally in the directory `/abci_build`.


## Subcommand `autonomy deploy from-token`


### Usage

### Description

### Options

### Examples


3. Run deployments

    ```
    Usage: autonomy deploy run [OPTIONS]

      Run deployment.

    Options:
    ```



4. One click deployments

    If you have a service registered on-chain you can deploy the services directly using token IDs generated after the minting the service component. See the [register a service on-chain](../../guides/register_packages_on_chain.md#register-a-service) guide for more information.

    ```
    Usage: autonomy deploy from-token [OPTIONS] TOKEN_ID KEYS_FILE

      Run service deployment.

    Options:
      --rpc TEXT      Custom RPC URL
      --sca TEXT      Service contract address for custom RPC URL.
      --n INTEGER     Number of agents to include in the build.
      --skip-image    Skip building images.
      --aev           Apply environment variable when loading service config.
      --use-goerli    Use goerli chain to resolve the token id.
      --use-ethereum  Use ethereum chain to resolve the token id.
      --use-staging   Use staging chain to resolve the token id.
      --help          Show this message and exit.
    ```

    To run a deployment for the on-chain service you need the token id for the minted service and funded keys. Save the keys in the `keys.json` and run

    ```
    $ autonomy deploy from-token <TOKEN_ID> keys.json
    ```

    Currently we support Autonolas staging chain, GÃ¶rli testnet and Ethereum mainnet for resolving on-chain token ids, but if you have a contract deployed on some other chain you can provide the RPC URL to the chain and contract address using `--rpc` and `--sca`.










2. Agent service images

    ```
    Usage: autonomy build-image [OPTIONS] [PUBLIC_ID_OR_HASH]

      Build runtime images for autonomous agents.

    Options:
      --service-dir PATH  Path to service dir.
      --version TEXT      Specify tag version for the image.
      --dev               Build development image.
      --pull              Pull latest dependencies.
      --help              Show this message and exit.
    ```

    ```
    # To build an image, navigate to the service dir and run
    $ autonomy build-image
    ```

    To execute this command you need to be located within a service directory. That is, a directory containing the service configuration file (`service.yaml`) and a file containing keys with funds for the chain you want to use. Images generated by this command will follow `valory/oar-<PUBLIC_ID>` format for labels.

    If you just want to build image for a specific agent without fetching a service run

    ```
    $ autonomy build-image PUBLIC_ID
    ```



You can see an example on how to use the commands in this section to build and run a local deployment (Hello world agent service) in the [quick start guide](../../guides/quick_start.md).
